{"version":3,"file":"admin_settings.min.js","sources":["../src/admin_settings.js"],"sourcesContent":["define([\"jquery\", \"core/str\"], function ($, Str) {\n  var AdminSettings = function (prompts, langs) {\n    this.existingPrompts = Object.values(prompts);\n    this.langs = Object.values(langs);\n    this.init();\n  };\n\n  AdminSettings.prototype.init = function () {\n    //handle modal outside click confirmation\n    $(document).click(async function (e) {\n      if (e.target.id === \"newPromptModal\") {\n        var confimationMsg = await Str.get_string(\"prompt_modal_close_warning\", \"smartlink\");\n        if (confirm(confimationMsg)) {\n          $(\".modal\").modal(\"toggle\");\n        }\n      }\n    });\n\n    //handle lang selection change\n    $(\".lang-selection\").click(function (e) {\n      e.preventDefault();\n      var content = $(this).html();\n      var attrVal = $(this).attr(\"data-id\");\n      $(\"input[name='language']\").val(attrVal);\n      $(\"#lang-selection-text\").html(content);\n    });\n\n    //handle status selection changes\n    $(\".status-selection\").click(function (e) {\n      e.preventDefault();\n      var content = $(this).html();\n      var attrVal = $(this).attr(\"data-id\");\n      $(\"input[name='active']\").val(attrVal);\n      $(\"#status-selection-text\").html(content);\n    });\n\n    $('form[name=\"prompt-form\"]').submit(function (e) {\n      e.preventDefault();\n      var promptVal = $(\"textarea[name='prompt']\").val();\n      if (promptVal.indexOf(\"{url}\") >= 0) {\n        $('form[name=\"prompt-form\"]')[0].submit();\n      } else {\n        $(\"textarea[name='prompt']\").addClass(\"is-invalid\");\n      }\n    });\n\n    $(\"#add-prompt-btn\").click(\n      async function () {\n        var addStr = await Str.get_string(\"add\", \"core\");\n        $(\"#add-update-btn\").html(addStr);\n        $(\"textarea[name='prompt']\").removeClass(\"is-invalid\");\n        var status = await Str.get_string(\"active\", \"core\");\n        $(\"input[name='id']\").val(0);\n        $(\"input[name='language']\").val(\"en\");\n        $(\"input[name='active']\").val(1);\n        $(\"input[name='action']\").val(\"add_prompt\");\n        //set default values\n        var initLang = this.langs[0];\n        $(\"input[name='language']\").val(initLang.code);\n        $(\"#lang-selection-text\").html(initLang.name);\n        $(\"input[name='active']\").val(1);\n        $(\"#status-selection-text\").html(status);\n        $(\".modal\").modal(\"toggle\");\n      }.bind(this)\n    );\n\n    $(\".modal\").on(\"hidden.bs.modal\", function () {\n      $(this).find(\"form\")[0].reset();\n      $(\".prompt-edit-warning\").css(\"display\", \"none\");\n    });\n\n    $(\"[data-dismiss='modal']\").on(\"click\", function () {\n      $('form[name=\"prompt-form\"]')[0].reset();\n      $(\".prompt-edit-warning\").css(\"display\", \"none\");\n    });\n\n    $(\".prompt-edit-icon\").click(\n      async function (e) {\n        e.preventDefault();\n        var attrVal = $(e.currentTarget).attr(\"data-id\");\n        var promptSetting = this.existingPrompts.find((prompt) => prompt.id == attrVal);\n\n        if (promptSetting) {\n          $(\".prompt-edit-warning\").css(\"display\", \"block\");\n          var updateStr = await Str.get_string(\"update\", \"core\");\n          $(\"#add-update-btn\").html(updateStr);\n          $(\"textarea[name='prompt']\").removeClass(\"is-invalid\");\n          $(\"input[name='id']\").val(promptSetting.id);\n          $(\"input[name='active']\").val(promptSetting.active);\n          $(\"input[name='action']\").val(\"add_prompt\");\n          $(\"textarea[name='prompt']\").val(promptSetting.prompt);\n          $(\"textarea[name='description']\").val(promptSetting.description);\n          var langSelected = this.langs.find((ln) => ln.code == promptSetting.language);\n          $(\"input[name='language']\").val(langSelected.code);\n          $(\"#lang-selection-text\").html(langSelected.name);\n          $(\"#status-selection-text\").html(promptSetting.status_string);\n          $(\".modal\").modal(\"toggle\");\n        }\n      }.bind(this)\n    );\n  };\n\n  return {\n    init: function (prompts, langs) {\n      return new AdminSettings(prompts, langs);\n    },\n  };\n});\n"],"names":["define","$","Str","AdminSettings","prompts","langs","existingPrompts","Object","values","init","prototype","document","click","async","e","target","id","confimationMsg","get_string","confirm","modal","preventDefault","content","this","html","attrVal","attr","val","submit","indexOf","addClass","addStr","removeClass","status","initLang","code","name","bind","on","find","reset","css","currentTarget","promptSetting","prompt","updateStr","active","description","langSelected","ln","language","status_string"],"mappings":"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"}