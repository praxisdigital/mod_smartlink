{"version":3,"file":"admin_settings.min.js","sources":["../src/admin_settings.js"],"sourcesContent":["import $ from 'jquery';\nimport * as Str from 'core/str';\n\nclass AdminSettings {\n\n    constructor(prompts, langs) {\n        this.existingPrompts = Object.values(prompts);\n        this.langs = Object.values(langs);\n        this.init();\n    }\n\n    init() {\n\n        // Handle modal outside click confirmation\n        $(document).click(async function (e) {\n            if (e.target.id === \"newPromptModal\") {\n                var confimationMsg = await Str.get_string(\"prompt_modal_close_warning\", \"smartlink\");\n                if (confirm(confimationMsg)) {\n                    $(\".modal\").modal(\"toggle\");\n                }\n            }\n        });\n\n        // Handle lang selection change\n        $(\".lang-selection\").click(function (e) {\n            e.preventDefault();\n            var content = $(this).html();\n            var attrVal = $(this).attr(\"data-id\");\n            $(\"input[name='language']\").val(attrVal);\n            $(\"#lang-selection-text\").html(content);\n        });\n\n        // Handle status selection changes\n        $(\".status-selection\").click(function (e) {\n            e.preventDefault();\n            var content = $(this).html();\n            var attrVal = $(this).attr(\"data-id\");\n            $(\"input[name='active']\").val(attrVal);\n            $(\"#status-selection-text\").html(content);\n        });\n\n        $('form[name=\"prompt-form\"]').submit(function (e) {\n            e.preventDefault();\n            var promptVal = $(\"textarea[name='prompt']\").val();\n            if (promptVal.indexOf(\"{url}\") >= 0) {\n                $('form[name=\"prompt-form\"]')[0].submit();\n            } else {\n                $(\"textarea[name='prompt']\").addClass(\"is-invalid\");\n            }\n        });\n\n        $(\"#add-prompt-btn\").click(\n            async function () {\n                var addStr = await Str.get_string(\"add\", \"core\");\n                $(\"#add-update-btn\").html(addStr);\n                $(\"textarea[name='prompt']\").removeClass(\"is-invalid\");\n                var status = await Str.get_string(\"active\", \"core\");\n                $(\"input[name='id']\").val(0);\n                $(\"input[name='language']\").val(\"en\");\n                $(\"input[name='active']\").val(1);\n                $(\"input[name='action']\").val(\"add_prompt\");\n                //set default values\n                var initLang = this.langs[0];\n                $(\"input[name='language']\").val(initLang.code);\n                $(\"#lang-selection-text\").html(initLang.name);\n                $(\"input[name='active']\").val(1);\n                $(\"#status-selection-text\").html(status);\n                $(\".modal\").modal(\"toggle\");\n            }.bind(this)\n        );\n\n        $(\".modal\").on(\"hidden.bs.modal\", function () {\n            $(this).find(\"form\")[0].reset();\n            $(\".prompt-edit-warning\").css(\"display\", \"none\");\n        });\n\n        $(\"[data-dismiss='modal']\").on(\"click\", function () {\n            $('form[name=\"prompt-form\"]')[0].reset();\n            $(\".prompt-edit-warning\").css(\"display\", \"none\");\n        });\n\n        $(\".prompt-edit-icon\").click(\n            async function (e) {\n                e.preventDefault();\n                var attrVal = $(e.currentTarget).attr(\"data-id\");\n                var promptSetting = this.existingPrompts.find((prompt) => prompt.id == attrVal);\n\n                if (promptSetting) {\n                    $(\".prompt-edit-warning\").css(\"display\", \"block\");\n                    var updateStr = await Str.get_string(\"update\", \"core\");\n                    $(\"#add-update-btn\").html(updateStr);\n                    $(\"textarea[name='prompt']\").removeClass(\"is-invalid\");\n                    $(\"input[name='id']\").val(promptSetting.id);\n                    $(\"input[name='active']\").val(promptSetting.active);\n                    $(\"input[name='action']\").val(\"add_prompt\");\n                    $(\"textarea[name='prompt']\").val(promptSetting.prompt);\n                    $(\"textarea[name='description']\").val(promptSetting.description);\n                    var langSelected = this.langs.find((ln) => ln.code == promptSetting.language);\n                    $(\"input[name='language']\").val(langSelected.code);\n                    $(\"#lang-selection-text\").html(langSelected.name);\n                    $(\"#status-selection-text\").html(promptSetting.status_string);\n                    $(\".modal\").modal(\"toggle\");\n                }\n            }.bind(this)\n        );\n\n    }\n\n}\n\nexport const init = (prompts, langs) => {\n    return new AdminSettings(prompts, langs);\n};\n"],"names":["AdminSettings","constructor","prompts","langs","existingPrompts","Object","values","init","document","click","async","e","target","id","confimationMsg","Str","get_string","confirm","modal","preventDefault","content","this","html","attrVal","attr","val","submit","indexOf","addClass","addStr","removeClass","status","initLang","code","name","bind","on","find","reset","css","currentTarget","promptSetting","prompt","updateStr","active","description","langSelected","ln","language","status_string"],"mappings":"kqCAGMA,cAEFC,YAAYC,QAASC,YACZC,gBAAkBC,OAAOC,OAAOJ,cAChCC,MAAQE,OAAOC,OAAOH,YACtBI,OAGTA,2BAGMC,UAAUC,OAAMC,eAAgBC,MACV,mBAAhBA,EAAEC,OAAOC,GAAyB,KAC9BC,qBAAuBC,IAAIC,WAAW,6BAA8B,aACpEC,QAAQH,qCACN,UAAUI,MAAM,kCAM5B,mBAAmBT,OAAM,SAAUE,GACjCA,EAAEQ,qBACEC,SAAU,mBAAEC,MAAMC,OAClBC,SAAU,mBAAEF,MAAMG,KAAK,+BACzB,0BAA0BC,IAAIF,6BAC9B,wBAAwBD,KAAKF,gCAIjC,qBAAqBX,OAAM,SAAUE,GACnCA,EAAEQ,qBACEC,SAAU,mBAAEC,MAAMC,OAClBC,SAAU,mBAAEF,MAAMG,KAAK,+BACzB,wBAAwBC,IAAIF,6BAC5B,0BAA0BD,KAAKF,gCAGnC,4BAA4BM,QAAO,SAAUf,GAC3CA,EAAEQ,kBACc,mBAAE,2BAA2BM,MAC/BE,QAAQ,UAAY,sBAC5B,4BAA4B,GAAGD,6BAE/B,2BAA2BE,SAAS,qCAI5C,mBAAmBnB,MACjBC,qBACQmB,aAAed,IAAIC,WAAW,MAAO,4BACvC,mBAAmBM,KAAKO,4BACxB,2BAA2BC,YAAY,kBACrCC,aAAehB,IAAIC,WAAW,SAAU,4BAC1C,oBAAoBS,IAAI,uBACxB,0BAA0BA,IAAI,0BAC9B,wBAAwBA,IAAI,uBAC5B,wBAAwBA,IAAI,kBAE1BO,SAAWX,KAAKlB,MAAM,uBACxB,0BAA0BsB,IAAIO,SAASC,0BACvC,wBAAwBX,KAAKU,SAASE,0BACtC,wBAAwBT,IAAI,uBAC5B,0BAA0BH,KAAKS,4BAC/B,UAAUb,MAAM,WACpBiB,KAAKd,2BAGT,UAAUe,GAAG,mBAAmB,+BAC5Bf,MAAMgB,KAAK,QAAQ,GAAGC,4BACtB,wBAAwBC,IAAI,UAAW,+BAG3C,0BAA0BH,GAAG,SAAS,+BAClC,4BAA4B,GAAGE,4BAC/B,wBAAwBC,IAAI,UAAW,+BAG3C,qBAAqB9B,MACnBC,eAAgBC,GACZA,EAAEQ,qBACEI,SAAU,mBAAEZ,EAAE6B,eAAehB,KAAK,WAClCiB,cAAgBpB,KAAKjB,gBAAgBiC,MAAMK,QAAWA,OAAO7B,IAAMU,aAEnEkB,cAAe,qBACb,wBAAwBF,IAAI,UAAW,aACrCI,gBAAkB5B,IAAIC,WAAW,SAAU,4BAC7C,mBAAmBM,KAAKqB,+BACxB,2BAA2Bb,YAAY,kCACvC,oBAAoBL,IAAIgB,cAAc5B,wBACtC,wBAAwBY,IAAIgB,cAAcG,4BAC1C,wBAAwBnB,IAAI,kCAC5B,2BAA2BA,IAAIgB,cAAcC,4BAC7C,gCAAgCjB,IAAIgB,cAAcI,iBAChDC,aAAezB,KAAKlB,MAAMkC,MAAMU,IAAOA,GAAGd,MAAQQ,cAAcO,+BAClE,0BAA0BvB,IAAIqB,aAAab,0BAC3C,wBAAwBX,KAAKwB,aAAaZ,0BAC1C,0BAA0BZ,KAAKmB,cAAcQ,mCAC7C,UAAU/B,MAAM,YAExBiB,KAAKd,sBAOC,CAACnB,QAASC,QACnB,IAAIH,cAAcE,QAASC"}