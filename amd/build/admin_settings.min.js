define("mod_smartlink/admin_settings",["exports","jquery","core/str"],(function(_exports,_jquery,Str){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj},Str=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Str);class AdminSettings{constructor(prompts,langs){this.existingPrompts=Object.values(prompts),this.langs=Object.values(langs),this.init()}init(){(0,_jquery.default)(document).click((async function(e){if("newPromptModal"===e.target.id){var confimationMsg=await Str.get_string("prompt_modal_close_warning","smartlink");confirm(confimationMsg)&&(0,_jquery.default)(".modal").modal("toggle")}})),(0,_jquery.default)(".lang-selection").click((function(e){e.preventDefault();var content=(0,_jquery.default)(this).html(),attrVal=(0,_jquery.default)(this).attr("data-id");(0,_jquery.default)("input[name='language']").val(attrVal),(0,_jquery.default)("#lang-selection-text").html(content)})),(0,_jquery.default)(".status-selection").click((function(e){e.preventDefault();var content=(0,_jquery.default)(this).html(),attrVal=(0,_jquery.default)(this).attr("data-id");(0,_jquery.default)("input[name='active']").val(attrVal),(0,_jquery.default)("#status-selection-text").html(content)})),(0,_jquery.default)('form[name="prompt-form"]').submit((function(e){e.preventDefault(),(0,_jquery.default)("textarea[name='prompt']").val().indexOf("{url}")>=0?(0,_jquery.default)('form[name="prompt-form"]')[0].submit():(0,_jquery.default)("textarea[name='prompt']").addClass("is-invalid")})),(0,_jquery.default)("#add-prompt-btn").click(async function(){var addStr=await Str.get_string("add","core");(0,_jquery.default)("#add-update-btn").html(addStr),(0,_jquery.default)("textarea[name='prompt']").removeClass("is-invalid");var status=await Str.get_string("active","core");(0,_jquery.default)("input[name='id']").val(0),(0,_jquery.default)("input[name='language']").val("en"),(0,_jquery.default)("input[name='active']").val(1),(0,_jquery.default)("input[name='action']").val("add_prompt");var initLang=this.langs[0];(0,_jquery.default)("input[name='language']").val(initLang.code),(0,_jquery.default)("#lang-selection-text").html(initLang.name),(0,_jquery.default)("input[name='active']").val(1),(0,_jquery.default)("#status-selection-text").html(status),(0,_jquery.default)(".modal").modal("toggle")}.bind(this)),(0,_jquery.default)(".modal").on("hidden.bs.modal",(function(){(0,_jquery.default)(this).find("form")[0].reset(),(0,_jquery.default)(".prompt-edit-warning").css("display","none")})),(0,_jquery.default)("[data-dismiss='modal']").on("click",(function(){(0,_jquery.default)('form[name="prompt-form"]')[0].reset(),(0,_jquery.default)(".prompt-edit-warning").css("display","none")})),(0,_jquery.default)(".prompt-edit-icon").click(async function(e){e.preventDefault();var attrVal=(0,_jquery.default)(e.currentTarget).attr("data-id"),promptSetting=this.existingPrompts.find((prompt=>prompt.id==attrVal));if(promptSetting){(0,_jquery.default)(".prompt-edit-warning").css("display","block");var updateStr=await Str.get_string("update","core");(0,_jquery.default)("#add-update-btn").html(updateStr),(0,_jquery.default)("textarea[name='prompt']").removeClass("is-invalid"),(0,_jquery.default)("input[name='id']").val(promptSetting.id),(0,_jquery.default)("input[name='active']").val(promptSetting.active),(0,_jquery.default)("input[name='action']").val("add_prompt"),(0,_jquery.default)("textarea[name='prompt']").val(promptSetting.prompt),(0,_jquery.default)("textarea[name='description']").val(promptSetting.description);var langSelected=this.langs.find((ln=>ln.code==promptSetting.language));(0,_jquery.default)("input[name='language']").val(langSelected.code),(0,_jquery.default)("#lang-selection-text").html(langSelected.name),(0,_jquery.default)("#status-selection-text").html(promptSetting.status_string),(0,_jquery.default)(".modal").modal("toggle")}}.bind(this))}}_exports.init=(prompts,langs)=>new AdminSettings(prompts,langs)}));

//# sourceMappingURL=admin_settings.min.js.map